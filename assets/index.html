<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Buoy default index -->
  <title>Buoy</title>
  <style>
    body { font-family: "Inter", system-ui, -apple-system, "Segoe UI", "Helvetica Neue", Arial, sans-serif; margin: 2rem auto; max-width: 42rem; color: #1f2933; padding: 0 1rem; box-sizing: border-box; }
    h1 { margin-bottom: 0.5rem; }
    p { margin-top: 0; line-height: 1.5; }
    section { margin-top: 1.5rem; }
    ul { list-style: none; padding-left: 0; margin: 0.75rem 0 0; display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 0.5rem 1rem; }
    li { margin: 0; }
    a { display: block; padding: 0.35rem 0.5rem; border-radius: 6px; background: #f5f7fa; color: inherit; text-decoration: none; }
    a:hover { text-decoration: underline; }
    @media (max-width: 900px) {
      ul { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 600px) {
      ul { grid-template-columns: 1fr; }
    }
    .muted { color: #52606d; }
  </style>
</head>
<body>
  <main>
    <h1>Welcome to Buoy</h1>
    <p>Buoy is running. Files are being served from <em>~/.local/share/buoy/www</em>. Add files or symlinks to that directory.</p>
    <section>
      <ul id="folder-list"></ul>
      <p id="folder-empty" class="muted" hidden>No folders yet.</p>
    </section>
  </main>
  <script>
    const list = document.getElementById("folder-list");
    const empty = document.getElementById("folder-empty");

    fetch("/folders")
      .then((response) => {
        if (!response.ok) {
          throw new Error("Failed to load folder list");
        }
        return response.json();
      })
      .then((folders) => {
        if (!Array.isArray(folders) || folders.length === 0) {
          empty.hidden = false;
          return;
        }
        folders.forEach((name) => {
          const item = document.createElement("li");
          const link = document.createElement("a");
          link.href = `/${encodeURIComponent(name)}`;
          link.textContent = name;
          item.appendChild(link);
          list.appendChild(item);
        });
      })
      .catch(() => {
        empty.textContent = "Folder list unavailable.";
        empty.hidden = false;
      });
  </script>
</body>
</html>
